<template>
  <div class="session">
    
    <div class= "scene-container"  v-bind:class="{flashing: isFlashing}">
      <div id="scene_start" sceneNumber="1" class = "scene" v-bind:class="{currentScene: showScene1}">
        <div class = "sceneLabel"> trial start scene </div>
        <button v-on:click="Scene1TrialStartNosepoke_onclick" class= "nosepokeLarge" v-bind:class="{nosepokeLargeOff: ITIOn}"></button>
        <div class= "nosepokeholescontainer">
          <button v-on:click="Scene1nosepokestim1_onclick" class="nosepoke nosepoke1"></button>
          <button v-on:click="Scene1nosepokestim2_onclick" class="nosepoke nosepoke2"></button>
          <button v-on:click="Scene1nosepokestim3_onclick" class="nosepoke nosepoke3"></button>
          <button v-on:click="Scene1nosepokestim4_onclick" class="nosepoke nosepoke4"></button>
          <button v-on:click="Scene1nosepokestim5_onclick" class="nosepoke nosepoke5"></button>
        </div>
      </div>
      <div id="scene_2"  sceneNumber="2" class = "scene" v-bind:class="{currentScene: showScene2}" >
          <div class = "sceneLabel"> stimulus presentation scene </div>
          <button class= "nosepokeLarge nosepokeLargeOff Scene2PerseverativeTrialStartNosepoke"></button>
          <div class= "nosepokeholescontainer">
            <button v-on:click="Scene2nosepokestim1_onclick" class="nosepoke nosepoke1" v-bind:class="{nosepokeActive: NosePokeStimulus_1}" ></button>
            <button v-on:click="Scene2nosepokestim2_onclick" class="nosepoke nosepoke2" v-bind:class="{nosepokeActive: NosePokeStimulus_2}" ></button>
            <button v-on:click="Scene2nosepokestim3_onclick" class="nosepoke nosepoke3" v-bind:class="{nosepokeActive: NosePokeStimulus_3}" ></button>
            <button v-on:click="Scene2nosepokestim4_onclick" class="nosepoke nosepoke4" v-bind:class="{nosepokeActive: NosePokeStimulus_4}" ></button>
            <button v-on:click="Scene2nosepokestim5_onclick" class="nosepoke nosepoke5" v-bind:class="{nosepokeActive: NosePokeStimulus_5}" ></button>
          </div>
      </div>
      <div id="scene_3" class = "scene" v-bind:class="{currentScene: showScene3}" >
          <div class = "sceneLabel"> win outcome scene</div>
          <button class= "nosepokeLarge nosepokeLargeOff Scene3PerseverativeTrialStartNosepoke"></button>
          
          <div class= "nosepokeholescontainer">
            <button class="nosepoke nosepoke1"></button>
            <button class="nosepoke nosepoke2"></button>
            <button class="nosepoke nosepoke3"></button>
            <button class="nosepoke nosepoke4"></button>
            <button class="nosepoke nosepoke5"></button>
          </div>
      </div>
      <div id="scene_4"  class = "scene" v-bind:class="{currentScene: showScene4}" >
          <div class = "aversiveLight"></div>
            <button class= "nosepokeLarge nosepokeLargeOff Scene4PerseverativeTrialStartNosepoke"></button>
        
          <div class= "nosepokeholescontainer">
            <button class="nosepoke nosepoke1"></button>
            <button class="nosepoke nosepoke2"></button>
            <button class="nosepoke nosepoke3"></button>
            <button class="nosepoke nosepoke4"></button>
            <button class="nosepoke nosepoke5"></button>
          </div>
      </div>

      <div id="scene_5"  class = "scene" v-bind:class="{currentScene: showScene5}" > </div>
    </div>
    
  </div>
</template>

<script>
export default {
  name: "exp1979",
  sockets: {
    connect: function() {
      console.log("session socket connected");
    },

    client_experiment_session_start: function(val) {
      this.config = val;
      this.running = true;
      console.log("client_experiment_session_start");
    },

    client_experiment_session_stop: function(val) {
      this.running = false;
      console.log("client_experiment_session_stop");
    },

    client_experiment_action: function(action) {
      console.log("client_experment_action", action);

      if (action.type.startsWith("ChangeToScene")) {
        this.showScene1 = false;
        this.showScene2 = false;
        this.showScene3 = false;
        this.showScene4 = false;
        this.showScene5 = false;

        switch (action.type) {
          case "ChangeToScene_start":
            this.currentScene = 1;
            this.showScene1 = true;
            this.ITIOn = false;
            break;
          case "ChangeToScene_2":
            this.currentScene = 2;
            this.showScene2 = true;
            break;
          case "ChangeToScene_3":
            this.currentScene = 3;
            this.showScene3 = true;
            break;
          case "ChangeToScene_4":
            this.currentScene = 4;
            this.showScene4 = true;
            break;
          case "ChangeToScene_5":
            this.currentScene = 5;
            this.showScene5 = true;
            break;
        }
      }

      if (action.type.startsWith("NosePokeStimulus_")) {
        this.NosePokeStimulus_1 = false;
        this.NosePokeStimulus_2 = false;
        this.NosePokeStimulus_3 = false;
        this.NosePokeStimulus_4 = false;
        this.NosePokeStimulus_5 = false;
        switch (action.type) {
          case "NosePokeStimulus_1":
            this.NosePokeStimulus_1 = true;
            break;
          case "NosePokeStimulus_2":
            this.NosePokeStimulus_2 = true;
            break;
          case "NosePokeStimulus_3":
            this.NosePokeStimulus_3 = true;
            break;
          case "NosePokeStimulus_4":
            this.NosePokeStimulus_4 = true;
            break;
          case "NosePokeStimulus_5":
            this.NosePokeStimulus_5 = true;
            break;
        }
      }

      if (action.type === "ITIOn") {
        this.ITIOn = true;
      }
    }
  },
  data() {
    return {
      config: {
        id: "Placeholder"
      },
      ruunning: false,
      isFlashing: false,
      currentScene: 0,
      showScene1: false,
      showScene2: false,
      showScene3: false,
      showScene4: false,
      showScene5: false,
      NosePokeStimulus_1: false,
      NosePokeStimulus_2: false,
      NosePokeStimulus_3: false,
      NosePokeStimulus_4: false,
      NosePokeStimulus_5: false,
      ITIOn: false
    };
  },
  mounted() {
    console.log("mounted");
    this.$socket.emit("client_experiment_onevent", { type: "UI_onReady" });
  },
  methods: {
    event: function(actionType) {
      this.$socket.emit("client_experiment_onevent", { type: actionType });
    },

    Scene1TrialStartNosepoke_onclick: function() {
      this.event("Scene1TrialStartNosepoke_onclick");
    },
    Scene1nosepokestim1_onclick: function() {
      this.event("PrematureResponse2");
    },
    Scene1nosepokestim2_onclick: function() {
      this.event("PrematureResponse2");
    },
    Scene1nosepokestim3_onclick: function() {
      this.event("PrematureResponse3");
    },
    Scene1nosepokestim4_onclick: function() {
      this.event("PrematureResponse4");
    },
    Scene1nosepokestim5_onclick: function() {
      this.event("PrematureResponse5");
    },
    Scene2nosepokestim1_onclick: function() {
      this.event("Scene2nosepokestim1_onclick");
    },
    Scene2nosepokestim2_onclick: function() {
      this.event("Scene2nosepokestim2_onclick");
    },
    Scene2nosepokestim3_onclick: function() {
      this.event("Scene2nosepokestim3_onclick");
    },
    Scene2nosepokestim4_onclick: function() {
      this.event("Scene2nosepokestim4_onclick");
    },
    Scene2nosepokestim5_onclick: function() {
      this.event("Scene2nosepokestim5_onclick");
    }
  }
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
h1,
h2 {
  font-weight: normal;
  float: left;
}
ul {
  list-style-type: none;
  padding: 0;
}
li {
  margin: 0 10px;
}
a {
  color: #42b983;
}
.session {
  color: white;
  height: 100vh;
  width: 100%;
  background-color: black;
}
.scene-container {
  height: 100%;
  width: 100%;
  background-color: black;
}
.scene {
  height: 480px;
  width: 800px;
  overflow: hidden;
  display: none;
}
.sceneLabel {
  position: relative;
  top: 0;
  left: 0;
}
.currentScene {
  display: block;
}
.aversiveLight {
  width: 200px;
  height: 200px;
  -moz-border-radius: 100px;
  -webkit-border-radius: 100px;
  border-radius: 100px;
  position: absolute;
  top: 50px;
  left: 50px;
  background-color: white;
}

@keyframes color-me-in {
  /* You could think of as "step 1" */
  0% {
    background: blue;
  }
  /* You could think of as "step 2" */
  50% {
    background: green;
  }

  100% {
    background: blue;
  }
}

.nosepoke {
  height: 100px;
  width: 100px;
  margin-left: 47px;
  background-color: white;
}
.nosepokeActive {
  background-color: yellow;
}

.nosepokeholescontainer {
  border: 1px rgb(153, 153, 155);
  position: absolute;
  top: 350px;
}
.nosepokeLarge {
  height: 150px;
  width: 150px;
  margin-left: 325px;
  animation-iteration-count: infinite;
  animation: color-me-in 10s;
  position: absolute;
  top: 90px;
}
.nosepokeLargeOff {
  background-color: rgb(153, 153, 155);
}
.flashing {
  background-color: white;
}
</style>

